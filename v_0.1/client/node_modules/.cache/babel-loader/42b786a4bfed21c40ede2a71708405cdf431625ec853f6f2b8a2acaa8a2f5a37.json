{"ast":null,"code":"'use strict';\n\nconst deferToConnect = require('defer-to-connect');\nmodule.exports = request => {\n  const timings = {\n    start: Date.now(),\n    socket: null,\n    lookup: null,\n    connect: null,\n    upload: null,\n    response: null,\n    end: null,\n    error: null,\n    phases: {\n      wait: null,\n      dns: null,\n      tcp: null,\n      request: null,\n      firstByte: null,\n      download: null,\n      total: null\n    }\n  };\n  const handleError = origin => {\n    const emit = origin.emit.bind(origin);\n    origin.emit = (event, ...args) => {\n      // Catches the `error` event\n      if (event === 'error') {\n        timings.error = Date.now();\n        timings.phases.total = timings.error - timings.start;\n        origin.emit = emit;\n      }\n\n      // Saves the original behavior\n      return emit(event, ...args);\n    };\n  };\n  let uploadFinished = false;\n  const onUpload = () => {\n    timings.upload = Date.now();\n    timings.phases.request = timings.upload - timings.connect;\n  };\n  handleError(request);\n  request.once('socket', socket => {\n    timings.socket = Date.now();\n    timings.phases.wait = timings.socket - timings.start;\n    const lookupListener = () => {\n      timings.lookup = Date.now();\n      timings.phases.dns = timings.lookup - timings.socket;\n    };\n    socket.once('lookup', lookupListener);\n    deferToConnect(socket, () => {\n      timings.connect = Date.now();\n      if (timings.lookup === null) {\n        socket.removeListener('lookup', lookupListener);\n        timings.lookup = timings.connect;\n        timings.phases.dns = timings.lookup - timings.socket;\n      }\n      timings.phases.tcp = timings.connect - timings.lookup;\n      if (uploadFinished && !timings.upload) {\n        onUpload();\n      }\n    });\n  });\n  request.once('finish', () => {\n    uploadFinished = true;\n    if (timings.connect) {\n      onUpload();\n    }\n  });\n  request.once('response', response => {\n    timings.response = Date.now();\n    timings.phases.firstByte = timings.response - timings.upload;\n    handleError(response);\n    response.once('end', () => {\n      timings.end = Date.now();\n      timings.phases.download = timings.end - timings.response;\n      timings.phases.total = timings.end - timings.start;\n    });\n  });\n  return timings;\n};","map":{"version":3,"names":["deferToConnect","require","module","exports","request","timings","start","Date","now","socket","lookup","connect","upload","response","end","error","phases","wait","dns","tcp","firstByte","download","total","handleError","origin","emit","bind","event","args","uploadFinished","onUpload","once","lookupListener","removeListener"],"sources":["/home/amfarwati/Documents/SPOC_Analyse_Impact_IT/v_0.1/client/node_modules/@szmarczak/http-timer/source/index.js"],"sourcesContent":["'use strict';\nconst deferToConnect = require('defer-to-connect');\n\nmodule.exports = request => {\n\tconst timings = {\n\t\tstart: Date.now(),\n\t\tsocket: null,\n\t\tlookup: null,\n\t\tconnect: null,\n\t\tupload: null,\n\t\tresponse: null,\n\t\tend: null,\n\t\terror: null,\n\t\tphases: {\n\t\t\twait: null,\n\t\t\tdns: null,\n\t\t\ttcp: null,\n\t\t\trequest: null,\n\t\t\tfirstByte: null,\n\t\t\tdownload: null,\n\t\t\ttotal: null\n\t\t}\n\t};\n\n\tconst handleError = origin => {\n\t\tconst emit = origin.emit.bind(origin);\n\t\torigin.emit = (event, ...args) => {\n\t\t\t// Catches the `error` event\n\t\t\tif (event === 'error') {\n\t\t\t\ttimings.error = Date.now();\n\t\t\t\ttimings.phases.total = timings.error - timings.start;\n\n\t\t\t\torigin.emit = emit;\n\t\t\t}\n\n\t\t\t// Saves the original behavior\n\t\t\treturn emit(event, ...args);\n\t\t};\n\t};\n\n\tlet uploadFinished = false;\n\tconst onUpload = () => {\n\t\ttimings.upload = Date.now();\n\t\ttimings.phases.request = timings.upload - timings.connect;\n\t};\n\n\thandleError(request);\n\n\trequest.once('socket', socket => {\n\t\ttimings.socket = Date.now();\n\t\ttimings.phases.wait = timings.socket - timings.start;\n\n\t\tconst lookupListener = () => {\n\t\t\ttimings.lookup = Date.now();\n\t\t\ttimings.phases.dns = timings.lookup - timings.socket;\n\t\t};\n\n\t\tsocket.once('lookup', lookupListener);\n\n\t\tdeferToConnect(socket, () => {\n\t\t\ttimings.connect = Date.now();\n\n\t\t\tif (timings.lookup === null) {\n\t\t\t\tsocket.removeListener('lookup', lookupListener);\n\t\t\t\ttimings.lookup = timings.connect;\n\t\t\t\ttimings.phases.dns = timings.lookup - timings.socket;\n\t\t\t}\n\n\t\t\ttimings.phases.tcp = timings.connect - timings.lookup;\n\n\t\t\tif (uploadFinished && !timings.upload) {\n\t\t\t\tonUpload();\n\t\t\t}\n\t\t});\n\t});\n\n\trequest.once('finish', () => {\n\t\tuploadFinished = true;\n\n\t\tif (timings.connect) {\n\t\t\tonUpload();\n\t\t}\n\t});\n\n\trequest.once('response', response => {\n\t\ttimings.response = Date.now();\n\t\ttimings.phases.firstByte = timings.response - timings.upload;\n\n\t\thandleError(response);\n\n\t\tresponse.once('end', () => {\n\t\t\ttimings.end = Date.now();\n\t\t\ttimings.phases.download = timings.end - timings.response;\n\t\t\ttimings.phases.total = timings.end - timings.start;\n\t\t});\n\t});\n\n\treturn timings;\n};\n"],"mappings":"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"},"metadata":{},"sourceType":"script","externalDependencies":[]}